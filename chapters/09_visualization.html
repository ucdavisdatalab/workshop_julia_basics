

<!DOCTYPE html>


<html lang="en-us" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>14. Data Visualization in Python &#8212; Julia Basics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/09_visualization';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15. Organizing Code" href="10_if-statements.html" />
    <link rel="prev" title="13. Exploring Data" href="08_iteration-aggregation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en-us"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/datalab-logo-full-color-rgb-1.png" class="logo__image only-light" alt="Julia Basics - Home"/>
    <script>document.write(`<img src="../_static/datalab-logo-full-color-rgb-1.png" class="logo__image only-dark" alt="Julia Basics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Overview
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Julia Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="21_syntax-features.html">1. Syntax and Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="23_types.html">2. Data Types and Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="22_reading-files.html">3. Reading and Writing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="24_data-frames.html">4. Data Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="25_data-viz.html">5. Data Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="26_case-studies.html">6. Case Studies</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Backmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="15_test.html">Test</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Basics (old material)</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_julia-basics.html">7. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_packages.html">8. Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_file-systems.html">9. File Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_data-types-structures.html">10. Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_indexing.html">11. Indexing in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_special-values.html">12. Special Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_iteration-aggregation.html">13. Exploring Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">14. Data Visualization in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_if-statements.html">15. Organizing Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_functions.html">16. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_more-data-structures.html">17. Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_web-apis.html">18. Surfing the Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_more-iteration.html">19. Loops</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ucdavisdatalab/workshop_julia_basics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ucdavisdatalab/workshop_julia_basics/issues/new?title=Issue%20on%20page%20%2Fchapters/09_visualization.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/09_visualization.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Visualization in Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparing-to-visualize">14.1. Preparing to Visualize</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-plotnine">14.1.1. Install and Import plotnine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-jupyter">14.1.2. Configure Jupyter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">14.1.3. Data Cleaning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-grammar-of-graphics">14.2. The Grammar of Graphics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-1-data">14.2.1. Layer 1: Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-2-geometry">14.2.2. Layer 2: Geometry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-3-aesthetics">14.2.3. Layer 3: Aesthetics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-4-scales">14.2.4. Layer 4: Scales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-plots">14.2.5. Saving Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bar-plot">14.2.6. Example: Bar Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-design">14.2.7. Visualization Design</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">14.3. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">14.3.1. Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">14.3.2. Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">14.3.3. Exercise</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <!--
---
jupytext:
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
kernelspec:
  display_name: Julia
  language: julia
  name: julia-1.10
---
-->
<section class="tex2jax_ignore mathjax_ignore" id="data-visualization-in-python">
<span id="id1"></span><h1><span class="section-number">14. </span>Data Visualization in Python<a class="headerlink" href="#data-visualization-in-python" title="Permalink to this heading">#</a></h1>
<img alt="A network of Python visualization packages." src="img/visualization_landscape.png" />
<p><em>Image from <a class="reference external" href="http://vanderplas.com/">Jake VanderPlas</a>. See <a class="reference external" href="https://rougier.github.io/python-visualization-landscape/landscape-colors.html">here</a> for a version with links
to all of the packages!</em></p>
<p>Creating aggregated information about a data set is often done with the intent
to share your results. A data visualization is an effective medium for
displaying results, and there are many ways to create one in Python. In fact,
so many visualization packages are available that there is even <a class="reference external" href="https://pyviz.org/">a
website</a> dedicated to helping people decide which to use. This reader
focuses on <strong>static visualization</strong>, where the visualization is a still image.
Some popular packages for creating static visualizations are:</p>
<ul class="simple">
<li><p><strong><a class="reference external" href="https://matplotlib.org/">matplotlib</a></strong> is the foundation for most other visualization packages.
matplotlib is low-level, meaning it’s flexible but even simple plots may take
<a class="reference external" href="https://dsaber.com/2016/10/02/a-dramatic-tour-through-pythons-data-visualization-landscape-including-ggplot-and-altair/">5 lines of code or more</a>. It’s good to know a little bit about
matplotlib, but it probably shouldn’t be your primary visualization package.
Familiarity with MATLAB makes it easier to learn matplotlib.</p></li>
<li><p><strong><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/visualization.html">pandas</a></strong> provides built-in plotting functions, which can be convenient
but are more limited than what you’ll find in dedicated visualization
packages. They’re also inconsistent about the expected format of the data.</p></li>
<li><p><strong><a class="reference external" href="https://plotnine.readthedocs.io/en/stable/">plotnine</a></strong> is a copy of the popular R package <a class="reference external" href="https://ggplot2.tidyverse.org/">ggplot2</a>. The package
uses the <strong>grammar of graphics</strong>, a convenient way to describe visualizations
in terms of layers. Familiarity with R’s <a class="reference external" href="https://ggplot2.tidyverse.org/">ggplot2</a> or Julia’s
<a class="reference external" href="http://gadflyjl.org/stable/">Gadfly.jl</a> package makes it easier to learn plotnine (and
vice-versa).</p></li>
<li><p><strong><a class="reference external" href="https://seaborn.pydata.org/">seaborn</a></strong> is designed specifically for making statistical plots. It’s
well-documented and stable.</p></li>
</ul>
<p>There are also many packages available for making <strong>interactive
visualizations</strong>.</p>
<p>This reader focuses on plotnine, so that the visualization skills you learn
here will also be relevant if you end up using R or Julia. plotnine has
detailed <a class="reference external" href="https://plotnine.readthedocs.io/en/stable/">documentation</a>. It’s also useful to look at the <a class="reference external" href="https://ggplot2.tidyverse.org/">ggplot2
documentation</a> and <a class="reference external" href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf">cheatsheet</a>.</p>
<section id="preparing-to-visualize">
<span id="id2"></span><h2><span class="section-number">14.1. </span>Preparing to Visualize<a class="headerlink" href="#preparing-to-visualize" title="Permalink to this heading">#</a></h2>
<p>Before building a visualization, you will need to do a few preparatory steps.</p>
<section id="install-and-import-plotnine">
<span id="install-import-plotnine"></span><h3><span class="section-number">14.1.1. </span>Install and Import plotnine<a class="headerlink" href="#install-and-import-plotnine" title="Permalink to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of writing, conda installs plotnine 0.9 and matplotlib 3.6.1 by default.
This is a problem, because plotnine 0.9 is incompatible with matplotilb &gt;= 3.6.</p>
<p>Incompatibility between different versions of packages is common and exactly
what conda was designed to solve. In this case, you can simply make sure that
you have a slightly older version of matplotlib by running this command in the
Terminal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="s1">&#39;matplotlib&lt;3.6&#39;</span>
</pre></div>
</div>
<p>The plotnine developers have already fixed the problem in the newest version of
plotnine, so once it’s available through conda, this workaround will no longer
be necessary.</p>
</div>
<p>While Matplotlib is included with Anaconda, plotnine is not. You will need to
install the plotnine package in order to use it. <code class="xref std std-numref docutils literal notranslate"><span class="pre">installing-packages</span></code>
showed you how to install packages with conda via the Terminal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">plotnine</span>
</pre></div>
</div>
<p>In <code class="xref std std-numref docutils literal notranslate"><span class="pre">modules</span></code>, you learned how to import a module in a Python package
with the <code class="docutils literal notranslate"><span class="pre">import</span></code> keyword. Python also provides a <code class="docutils literal notranslate"><span class="pre">from</span></code> keyword to import
specific objects from within a module, so that you can access them without the
module name as a prefix. The syntax is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">MODULE</span> <span class="kn">import</span> <span class="n">OBJECT</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">MODULE</span></code> with the name of the module and <code class="docutils literal notranslate"><span class="pre">OBJECT</span></code> with the name of the
object that you want to import.</p>
<p>For instance, if you import Pandas using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
</pre></div>
</div>
<p>You can then write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">from</span></code> keyword to import all objects in a module with the
wildcard character <code class="docutils literal notranslate"><span class="pre">*</span></code>. Generally you shouldn’t do this, because objects in a
module will overwrite objects in your code if they have the same name. However,
the plotnine package was designed to be imported this way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</section>
<section id="configure-jupyter">
<span id="id3"></span><h3><span class="section-number">14.1.2. </span>Configure Jupyter<a class="headerlink" href="#configure-jupyter" title="Permalink to this heading">#</a></h3>
<p>Jupyter notebooks can display most static visualizations and some interactive
visualizations. If you’re going to use visualization packages that depend on
Matplotlib (such as plotnine), it’s a good idea to set up your notebook by
running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>The last line sets the default size of plots. You can increase the numbers to
make plots larger, or decrease them to make plots smaller.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In older versions of Jupyter and IPython, it was also necessary to run the
special IPython command <code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">inline</span></code> to set up a notebook for plotting.
This is no longer necessary in modern versions, but you may still see people
use or mention it online. You can read more about this change in <a class="reference external" href="https://stackoverflow.com/questions/65934740/is-matplotlib-inline-still-needed">this
StackOverflow question</a>.</p>
</div>
</section>
<section id="data-cleaning">
<span id="id4"></span><h3><span class="section-number">14.1.3. </span>Data Cleaning<a class="headerlink" href="#data-cleaning" title="Permalink to this heading">#</a></h3>
<p>Finally, we need to do a small amount of data cleaning. The plots below will
focus on two variables, <code class="docutils literal notranslate"><span class="pre">death_year</span></code> and <code class="docutils literal notranslate"><span class="pre">scaled_bill_value</span></code>. But some rows
lack information for these variables, so they need to be removed. Along the
way, we will ensure that the variables’ datatypes are set correctly.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When making potentially destructive changes to a data set, it’s a good idea to
reassign the altered data to a new variable.</p>
</div>
<p><strong>Death year</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">no_death</span> <span class="o">=</span> <span class="n">banknotes</span><span class="p">[</span><span class="s2">&quot;death_year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">])</span>
<span class="n">to_plot</span> <span class="o">=</span> <span class="n">banknotes</span><span class="p">[</span><span class="n">no_death</span> <span class="o">==</span> <span class="kc">False</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">to_plot</span><span class="p">[</span><span class="s2">&quot;death_year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_plot</span><span class="p">[</span><span class="s2">&quot;death_year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Scaled bill value</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">no_scaled</span> <span class="o">=</span> <span class="n">to_plot</span><span class="p">[</span><span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">to_plot</span> <span class="o">=</span> <span class="n">to_plot</span><span class="p">[</span><span class="n">no_scaled</span> <span class="o">==</span> <span class="kc">False</span><span class="p">]</span>
</pre></div>
</div>
<p>You are now ready to make a plot.</p>
</section>
</section>
<section id="the-grammar-of-graphics">
<span id="grammar-of-graphics"></span><h2><span class="section-number">14.2. </span>The Grammar of Graphics<a class="headerlink" href="#the-grammar-of-graphics" title="Permalink to this heading">#</a></h2>
<p>Recall that plotnine is a clone of ggplot2. The “gg” in ggplot2 stands for
<em>grammar of graphics</em>. The idea of a grammar of graphics is that visualizations
can be built up in layers. Visualizations that adhere to this grammar must
have:</p>
<ul class="simple">
<li><p>Data</p></li>
<li><p>Geometry</p></li>
<li><p>Aesthetics</p></li>
</ul>
<p>There are also several optional layers. Here are a few:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p>Layer</p></th>
<th class="text-left head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>scales</p></td>
<td class="text-left"><p>Title, label, and axis value settings</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>facets</p></td>
<td class="text-left"><p>Side-by-side plots</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>guides</p></td>
<td class="text-left"><p>Axis and legend position settings</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>annotations</p></td>
<td class="text-left"><p>Shapes that are not mapped to data</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>coordinates</p></td>
<td class="text-left"><p>Coordinate systems (Cartesian, logarithmic, polar)</p></td>
</tr>
</tbody>
</table>
<p>With all this in mind, it’s time to make a plot. But what kind of plot should
we make? It depends on what we want to know about the data set. Suppose we want
to understand the relationship between a banknote’s value and how long ago the
person on the banknote died, as well as whether this is affected by gender. One
way to show this is to make a scatter plot.</p>
<section id="layer-1-data">
<h3><span class="section-number">14.2.1. </span>Layer 1: Data<a class="headerlink" href="#layer-1-data" title="Permalink to this heading">#</a></h3>
<p>The data layer determines the data set used to make the plot. plotnine is
designed to work with <em>tidy</em> data. Tidy means:</p>
<ol class="arabic simple">
<li><p>Each observation has its own row</p></li>
<li><p>Each feature has its own column</p></li>
<li><p>Each value has its own cell</p></li>
</ol>
<p>Tidy data sets are convenient in general. A later lesson will cover how to make
an untidy data set tidy. Until then, we’ll take it for granted that the data
sets we work with are tidy.</p>
<p>To set up the data layer, call the ``ggplot` function on a Data Frame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">)</span>
</pre></div>
</div>
<p>This returns a blank plot. We still need to add a few more layers.</p>
</section>
<section id="layer-2-geometry">
<h3><span class="section-number">14.2.2. </span>Layer 2: Geometry<a class="headerlink" href="#layer-2-geometry" title="Permalink to this heading">#</a></h3>
<p>The geometry layer determines the shape or appearance of the visual elements of
the plot. In other words, the geometry layer determines what kind of plot to
make: one with points, lines, boxes, or something else.</p>
<p>There are many different geometries available in plotnine. The package provides
a function for each geometry, always prefixed with <code class="docutils literal notranslate"><span class="pre">geom_</span></code>.</p>
<p>To add a geometry layer to the plot, choose the <code class="docutils literal notranslate"><span class="pre">geom_</span></code> function you want and
add it to the plot with the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">:</span><span class="n">tags</span><span class="p">:</span> <span class="p">[</span><span class="n">raises</span><span class="o">-</span><span class="n">exception</span><span class="p">]</span>
<span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_point</span><span class="p">()</span>
</pre></div>
</div>
<p>This returns an error message that we’re missing aesthetics <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>. We’ll
learn more about aesthetics in the next section, but this error message is
especially helpful: it tells us exactly what we’re missing. When you use a
geometry you’re unfamiliar with, it can be helpful to run the code for just the
data and geometry layer like this, to see exactly which aesthetics need to be
set.</p>
<p>As we’ll see later, it’s possible to add multiple geometries to a plot.</p>
</section>
<section id="layer-3-aesthetics">
<h3><span class="section-number">14.2.3. </span>Layer 3: Aesthetics<a class="headerlink" href="#layer-3-aesthetics" title="Permalink to this heading">#</a></h3>
<p>The aesthetic layer determines the relationship between the data and the
geometry. Use the aesthetic layer to map features in the data to aesthetics
(visual elements) of the geometry.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">aes</span></code> function creates an aesthetic layer. The syntax is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">aes</span><span class="p">(</span><span class="n">AESTHETIC</span> <span class="o">=</span> <span class="n">FEATURE</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>The names of the aesthetics depend on the geometry, but some common ones are
<code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">color</span></code>, <code class="docutils literal notranslate"><span class="pre">fill</span></code>, <code class="docutils literal notranslate"><span class="pre">shape</span></code>, and <code class="docutils literal notranslate"><span class="pre">size</span></code>. There is more information about
and examples of aesthetic names in the documentation.</p>
<p>For example, we want to put <code class="docutils literal notranslate"><span class="pre">death_year</span></code> on the x-axis and <code class="docutils literal notranslate"><span class="pre">scalled_bill_value</span></code>
on the y-axis. It’s best to use <code class="docutils literal notranslate"><span class="pre">scaled_bill_value</span></code> here rather than
<code class="docutils literal notranslate"><span class="pre">current_bill_value</span></code> because different countries use different scales of
curency. One United States Dollar is worth approximately one hundred Japanese
Yen, for example. Below, we will set the aesthetics for both of these values.
Notice however that the aesthetic layer is not added to the plot with the <code class="docutils literal notranslate"><span class="pre">+</span></code>
operator. Instead, it is passed as the second argument to the <code class="docutils literal notranslate"><span class="pre">ggplot</span></code>
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ggplot</span><span class="p">(</span>
    <span class="n">to_plot</span><span class="p">,</span>
    <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;death_year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">)</span>
<span class="p">)</span> <span class="o">+</span> <span class="n">geom_point</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Per-geometry Aesthetics</strong></p>
<p>When you add the aesthetic layer or pass it to the <code class="docutils literal notranslate"><span class="pre">ggplot</span></code> function, it
applies to the entire plot. You can also set an aesthetic layer individually
for each geometry by passing the layer as the first argument in the <code class="docutils literal notranslate"><span class="pre">geom_</span></code>
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;death_year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Enclose expressions with <code class="docutils literal notranslate"><span class="pre">()</span></code> to create multiline code. It would be possible to
write out all of the above on one line, but this would come at the expense of
readability.</p>
</div>
<p>This is really only useful when you have multiple geometries. As an example,
let’s color-code the points by gender. To do so, we need to convert <code class="docutils literal notranslate"><span class="pre">gender</span></code> to
<em>categorical</em> data, which measures a qualitative category.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;death_year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;factor(gender)&quot;</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now let’s add labels to each point. To do this, we need to add another
geometry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">,</span>
    <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;death_year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;factor(gender)&quot;</span><span class="p">,</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span> <span class="o">+</span>
    <span class="n">geom_point</span><span class="p">()</span> <span class="o">+</span> 
    <span class="n">geom_text</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Where you put the aesthetics matters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">,</span>
    <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;death_year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span> <span class="o">+</span> 
    <span class="n">geom_point</span><span class="p">()</span> <span class="o">+</span> 
    <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;factor(gender)&quot;</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Constant Aesthetics</strong></p>
<p>If you want to set an aesthetic to a constant value, rather than one that’s
data dependent, do so in the geometry layer rather than the aesthetic layer.
For instance, suppose you want to use point shape rather than color to indicate
gender, and you want to make all of the points blue.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">,</span>
    <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;death_year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;factor(gender)&quot;</span><span class="p">))</span> <span class="o">+</span>
    <span class="n">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>If you set an aesthetic to a constant value inside of the aesthetic layer, the
results you get might not be what you expect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">:</span><span class="n">tags</span><span class="p">:</span> <span class="p">[</span><span class="n">raises</span><span class="o">-</span><span class="n">exception</span><span class="p">]</span>
<span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">,</span>
    <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;death_year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;factor(gender)&quot;</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">))</span> <span class="o">+</span>
    <span class="n">geom_point</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="layer-4-scales">
<h3><span class="section-number">14.2.4. </span>Layer 4: Scales<a class="headerlink" href="#layer-4-scales" title="Permalink to this heading">#</a></h3>
<p>The scales layer controls the title, axis labels, and axis scales of the plot.
Most of the functions in the scales layer are prefixed with <code class="docutils literal notranslate"><span class="pre">scale_</span></code>, but not
all of them.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">labs</span></code> function is especially important, because it’s used to set the title
and axis labels. All graphs need a title and axis labels.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">,</span>
    <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;death_year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;factor(gender)&quot;</span><span class="p">))</span> <span class="o">+</span> 
    <span class="n">geom_point</span><span class="p">()</span> <span class="o">+</span>
    <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Death Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Scaled Bill Value&quot;</span><span class="p">,</span>
         <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Does death year affect bill value?&quot;</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;Gender&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="saving-plots">
<h3><span class="section-number">14.2.5. </span>Saving Plots<a class="headerlink" href="#saving-plots" title="Permalink to this heading">#</a></h3>
<p>If you assign a plot to a variable, you can use the <code class="docutils literal notranslate"><span class="pre">save</span></code> method or the
<code class="docutils literal notranslate"><span class="pre">ggsave</span></code> function to save that plot to a file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">,</span>
    <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;death_year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;scaled_bill_value&quot;</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;factor(gender)&quot;</span><span class="p">))</span> <span class="o">+</span>
    <span class="n">geom_point</span><span class="p">()</span> <span class="o">+</span>
    <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Death Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Scaled Bill Value&quot;</span><span class="p">,</span> 
         <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Does death year affect bill value?&quot;</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;Gender&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">ggsave</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">&quot;myplot.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The file format is selected automatically based on the extension. Common
formats are PNG and PDF.</p>
</section>
<section id="example-bar-plot">
<span id="id5"></span><h3><span class="section-number">14.2.6. </span>Example: Bar Plot<a class="headerlink" href="#example-bar-plot" title="Permalink to this heading">#</a></h3>
<p>Now suppose you want to plot the number of banknotes with people from each
profession in the banknotes data set. A bar plot is an appropriate way to
represent this visually.</p>
<p>The geometry for a bar plot is <code class="docutils literal notranslate"><span class="pre">geom_bar</span></code>. Since bar plots are mainly used to
display frequencies, the <code class="docutils literal notranslate"><span class="pre">geom_bar</span></code> function automatically computes frequencies
when used in conjunction with the <code class="docutils literal notranslate"><span class="pre">factor()</span></code> syntax from above.</p>
<p>We can also use a fill color to further breakdown the bars by gender. Here’s
the code to make the bar plot:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">to_plot</span><span class="p">,</span>
    <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;factor(profession)&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s2">&quot;factor(gender)&quot;</span><span class="p">))</span> <span class="o">+</span>
    <span class="n">geom_bar</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="s2">&quot;dodge&quot;</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The setting <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">=</span> <span class="pre">&quot;dodge&quot;</span></code> instructs <code class="docutils literal notranslate"><span class="pre">geom_bar</span></code> to put the bars
side-by-side rather than stacking them. Adding <code class="docutils literal notranslate"><span class="pre">theme</span></code> allows you to change how
the axis labels and ticks are formatted.</p>
<p>In some cases, you may want to make a bar plot with frequencies you’ve already
computed. To prevent <code class="docutils literal notranslate"><span class="pre">geom_bar</span></code> from computing frequencies automatically, set
<code class="docutils literal notranslate"><span class="pre">stat</span> <span class="pre">=</span> <span class="pre">&quot;identity&quot;</span></code>.</p>
</section>
<section id="visualization-design">
<span id="id6"></span><h3><span class="section-number">14.2.7. </span>Visualization Design<a class="headerlink" href="#visualization-design" title="Permalink to this heading">#</a></h3>
<p>Designing high-quality visualizations goes beyond just mastering which Python
functions to call. You also need to think carefully about what kind of data you
have and what message you want to convey. This section provides a few
guidelines.</p>
<p>The first step in data visualization is choosing an appropriate kind of plot.
Here are some suggestions (not rules):</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p>Feature 1</p></th>
<th class="text-left head"><p>Feature 2</p></th>
<th class="text-left head"><p>Plot</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>categorical</p></td>
<td class="text-left"><p>categorical</p></td>
<td class="text-left"><p>bar, dot</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>categorical</p></td>
<td class="text-left"><p>categorical</p></td>
<td class="text-left"><p>bar, dot, mosaic</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>numerical</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p>box, density, histogram</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>numerical</p></td>
<td class="text-left"><p>categorical</p></td>
<td class="text-left"><p>box, density, ridge</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>numerical</p></td>
<td class="text-left"><p>numerical</p></td>
<td class="text-left"><p>line, scatter, smooth scatter</p></td>
</tr>
</tbody>
</table>
<p>If you want to add a:</p>
<ul class="simple">
<li><p>3rd numerical feature, use it to change point/line size</p></li>
<li><p>3rd categorical feature, use it to change point/line style</p></li>
<li><p>4th categorical feature, use side-by-side plots</p></li>
</ul>
<p>Once you’ve selected a plot, here are some rules you should almost always
follow:</p>
<ul class="simple">
<li><p>Always add a title and axis labels. These should be descriptive, not variable
names!</p></li>
<li><p>Specify units after the axis label if the axis has units. For instance,
“Height (ft)”</p></li>
<li><p>Don’t forget that many people are colorblind! Also, plots are often printed
in black and white. Use point and line styles to distinguish groups; color is
optional</p></li>
<li><p>Add a legend whenever you’ve used more than one point or line style</p></li>
<li><p>Always write a few sentences explaining what the plot shows. Don’t describe
the plot, because the reader can just look at it. Instead, explain what they
can learn from the plot and point out important details that may be
overlooked</p></li>
<li><p>For side-by-side plots, use the same axis scales for both plots so that
comparing them is not deceptive</p></li>
</ul>
<p>Visualization design is a deep topic, and whole books have been written about
it. One resource where you can learn more is DataLab’s <a class="reference external" href="https://ucdavisdatalab.github.io/workshop_data_viz_principles/">Principle’s of Data
Visualization Workshop Reader</a>.</p>
</section>
</section>
<section id="exercises">
<h2><span class="section-number">14.3. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<section id="exercise">
<h3><span class="section-number">14.3.1. </span>Exercise<a class="headerlink" href="#exercise" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Compute the number of banknotes that feature a person who died before 1990.</p></li>
<li><p>Of those people, how many were activists?</p></li>
</ol>
</section>
<section id="id7">
<h3><span class="section-number">14.3.2. </span>Exercise<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Compute the range of <code class="docutils literal notranslate"><span class="pre">first_appearance_year</span></code> for each country.</p>
<ul class="simple">
<li><p>Hint: this would be a good place to try out a multi-function
aggregation…</p></li>
</ul>
</li>
<li><p>How many unique values are there among the first and last values of
<code class="docutils literal notranslate"><span class="pre">first_appearance_year</span></code>?</p></li>
</ol>
</section>
<section id="id8">
<h3><span class="section-number">14.3.3. </span>Exercise<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Compute the set of banknotes who died in this century.</p></li>
<li><p>Use plotnine’s <code class="docutils literal notranslate"><span class="pre">geom_segment</span></code> function to create a plot which shows the
timespan between death year and first appearance as a horizontal segment for
each banknote. Put the name of each person on the y-axis. Color code the
segments by gender.</p>
<ul class="simple">
<li><p>Hint: you can make the plot more visually appealing if you first sort the
death year. You can use the <code class="docutils literal notranslate"><span class="pre">.sort_values</span></code> method to sort a DataFrame on
a column, or set of columns. Be aware that the default parameter for one
of the arguments is probably not what you’re expecting.</p></li>
</ul>
</li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="08_iteration-aggregation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">13. </span>Exploring Data</p>
      </div>
    </a>
    <a class="right-next"
       href="10_if-statements.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">15. </span>Organizing Code</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparing-to-visualize">14.1. Preparing to Visualize</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-plotnine">14.1.1. Install and Import plotnine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-jupyter">14.1.2. Configure Jupyter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">14.1.3. Data Cleaning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-grammar-of-graphics">14.2. The Grammar of Graphics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-1-data">14.2.1. Layer 1: Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-2-geometry">14.2.2. Layer 2: Geometry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-3-aesthetics">14.2.3. Layer 3: Aesthetics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-4-scales">14.2.4. Layer 4: Scales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-plots">14.2.5. Saving Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bar-plot">14.2.6. Example: Bar Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-design">14.2.7. Visualization Design</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">14.3. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">14.3.1. Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">14.3.2. Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">14.3.3. Exercise</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Derek Devnich, Ezra Morrison, Carl Stahmer, Nick Ulle
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
  <img alt="CC BY-SA 4.0" src="https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-lightgrey.svg"> 
</a>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>